{"version":3,"file":"static/js/286.cdea49d9.chunk.js","mappings":"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","sources":["constants/links.js","components/DNDList.jsx","components/ImageCardConstructorFactory.jsx","hooks/useFetch.js","pages/processPage/index.jsx","hooks/useSendFiles.jsx","webpack:///./src/pages/startPageStyle.css?064c"],"sourcesContent":["const hostName = window.location.hostname.toLowerCase();\r\n\r\nconst basicLink = process.env.NODE_ENV === \"development\" ? \"http://localhost:8000/\" : \"/\"\r\n\r\nconst devLinks = {\r\n    functionResolver : basicLink + \"api/FunctionResolver\",\r\n}\r\n\r\n\r\n\r\n\r\nconst links = process.env.NODE_ENV === \"development\" ? devLinks : devLinks;\r\n\r\nexport default links","import React, { Component, useReducer , useState} from \"react\";\r\n\r\n\r\nimport { DragDropContext, Droppable, Draggable } from \"react-beautiful-dnd\";\r\n\r\n\r\nconst reorder = (list, startIndex, endIndex) => {\r\n  const result = Array.from(list);\r\n  const [removed] = result.splice(startIndex, 1);\r\n  result.splice(endIndex, 0, removed);\r\n  return result;\r\n};\r\n\r\nconst grid = 8;\r\n\r\nconst getItemStyle = (isDragging) => ({\r\n  // some basic styles to make the items look a bit nicer\r\n  userSelect: \"none\",\r\n  padding: grid * 2,\r\n  margin: `0 0 ${grid}px 0`,\r\n  // change background colour if dragging\r\n  background: isDragging ? \"lightgreen\" : \"grey\",\r\n\r\n});\r\n\r\nconst getListStyle = isDraggingOver => ({\r\n  background: isDraggingOver ? \"lightblue\" : \"lightgrey\",\r\n  padding: grid,\r\n  width: 250\r\n});\r\n\r\n\r\nexport default function DNDList({items, setItems, getListStyle, getItemStyle, content, itemClickHandler=()=>{}}) {\r\n\r\n\r\n  function onDragEnd(result) {\r\n      console.log(result)\r\n     if (!result.destination) {\r\n      return;\r\n    }\r\n    setItems(reorder(items,\r\n        result.source.index,\r\n      result.destination.index))\r\n\r\n  }\r\n\r\n  return (\r\n     <DragDropContext onDragEnd={onDragEnd}>\r\n        <Droppable droppableId=\"droppable\">\r\n          {(provided, snapshot) => (\r\n            <div\r\n              {...provided.droppableProps}\r\n              ref={provided.innerRef}\r\n              style={getListStyle(snapshot.isDraggingOver)}\r\n            >\r\n              {items.map((item, index) => (\r\n                <Draggable key={item.id} draggableId={item.id} index={index}>\r\n                  {(provided, snapshot) => {\r\n                      \r\n                     return <div\r\n                      onClick={(event) => itemClickHandler(item, event)}\r\n                      ref={provided.innerRef}\r\n                      {...provided.draggableProps}\r\n                      {...provided.dragHandleProps}\r\n                      style={{...getItemStyle(\r\n                        snapshot.isDragging, item\r\n                      ), ...provided.draggableProps.style}}\r\n                    >\r\n                      {content(item, index)}\r\n                    </div>\r\n\r\n                  }\r\n                  }\r\n                </Draggable>\r\n              ))}\r\n              {provided.placeholder}\r\n            </div>\r\n          )}\r\n        </Droppable>\r\n      </DragDropContext>\r\n  );\r\n}\r\n","import React, {useState} from 'react'\r\n\r\nimport CloudUploadIcon from '@mui/icons-material/CloudUpload';\r\nimport ZoomInIcon from '@mui/icons-material/ZoomIn';\r\nimport CloseIcon from '@mui/icons-material/Close';\r\nimport CheckBoxIcon from '@mui/icons-material/CheckBox';\r\nimport VisibilityIcon from '@mui/icons-material/Visibility';\r\nimport VisibilityOffIcon from '@mui/icons-material/VisibilityOff';\r\n\r\nimport Dialog from '@mui/material/Dialog';\r\nimport DialogContent from '@mui/material/DialogContent';\r\nimport Tooltip from '@mui/material/Tooltip';\r\nimport { IconButton } from '@mui/material';\r\n\r\n\r\nfunction ZoomableImage({file, name, setZoomed}){\r\n    const [hovered, setHovered] = useState(false)\r\n\r\n    function handleClick(event){\r\n        event.stopPropagation()\r\n        setZoomed(file)\r\n    }\r\n    return <img src={file} alt={name} className='zoomableImageContent' onClick={handleClick}/> \r\n}\r\n\r\nconst getItemStyle = (isDragging, item) => ({\r\n    border: '1px solid lightgray',\r\n    borderRadius: '1.5rem',\r\n    background: 'white',\r\n    padding : 3,\r\n    margin : 2,\r\n    overflow: 'hidden',\r\n    display: 'flex',\r\n    alignItems: 'center',\r\n    opacity : item.visible ? 1 : 0.5, \r\n    userSelect: \"none\",\r\n    background: !isDragging ? \"white\" : \"lightgrey\",\r\n});\r\n\r\nconst getListStyle = isDraggingOver => ({\r\n    display: \"flex\",\r\n    flexDirection: 'column',\r\n    width: '100%',\r\n    background: isDraggingOver ? \"rgba(0,255,255,0.1)\" : \"transparent\",\r\n});\r\n\r\n\r\nconst ImageCardConstructorFactory = ({setZoomed, updateFiles, canRemove=false}) => \r\n                                ({file, progress, loaded, preview, id, visible}, index) => {\r\n                                    return <React.Fragment>\r\n                                        <div style={{marginRight: 'auto'}}>{canRemove ?<Tooltip title={\"Убрать картинку\"}>\r\n                                                <IconButton onClick={() => updateFiles({type: 'remove', id})}>\r\n                                                    <CloseIcon/>\r\n                                                </IconButton>\r\n                                            </Tooltip> : null}\r\n                                            <Tooltip title={visible ? \"Не использовать картинку\" : \"Использовать картинку\"}>\r\n                                                <IconButton onClick={() => updateFiles({type: 'visibility', id, visible: !visible})}>\r\n                                                    {visible ? <VisibilityIcon/> : <VisibilityOffIcon />}\r\n                                                </IconButton>\r\n                                        </Tooltip>{index+1}) {file.name}</div> \r\n                                        {loaded \r\n                                            ? <ZoomableImage file={preview} name={file.name} setZoomed={setZoomed}/>\r\n                                            : `${Math.round(progress * 10000) / 100}%`\r\n                                        }\r\n                                    </React.Fragment>\r\n                                }\r\nexport default ImageCardConstructorFactory;\r\nexport {getItemStyle, getListStyle}","import axios from \"axios\"\r\nimport { useCallback, useEffect, useState } from \"react\"\r\n\r\n\r\nconst defaultProps = {\r\n    method : 'get',\r\n    headers: {\r\n      \"Content-Type\": \"application/x-www-form-urlencoded\",\r\n      //\"Cache-Control\": \"no-cache\"\r\n    },\r\n    cors: false,\r\n}\r\n\r\nexport default function useFetch(initialProps={}){\r\n    const [err, setError] = useState(null)\r\n    const [isLoading, setIsLoading] = useState(false)\r\n    const [response, setResponse] = useState(null)\r\n    const [props, setProps] = useState(null)\r\n\r\n    useEffect(() => {\r\n        const doRequest = async () => {\r\n\r\n            const finalProps = {\r\n                    ...defaultProps,\r\n                    ...initialProps,\r\n                    ...props\r\n                }\r\n            // console.log('axios',  finalProps)\r\n            const resp = await axios(finalProps)\r\n            setResponse(resp)\r\n        }\r\n\r\n        if(isLoading)\r\n        {\r\n            (async () => {\r\n                try{\r\n                    await doRequest()\r\n                }catch(err){\r\n                    console.error(err)\r\n                    setError(err)\r\n                }\r\n        setIsLoading(false)\r\n            })()\r\n        }\r\n    }, [isLoading, props])\r\n\r\n\r\n    const doFetch = useCallback((props={}) => {\r\n        setIsLoading(true)\r\n        setResponse(null)\r\n        setError(null)\r\n        setProps(props)\r\n    }, [setIsLoading, setResponse, setError])\r\n\r\n    return {doFetch, error : err, isLoading, response}\r\n  \r\n}","import React, {\r\n  useCallback,\r\n  useEffect,\r\n  useReducer,\r\n  useRef,\r\n  useState,\r\n} from \"react\";\r\nimport { Redirect } from \"react-router-dom\";\r\n\r\nimport CheckBoxIcon from \"@mui/icons-material/CheckBox\";\r\nimport ArrowBackIcon from \"@mui/icons-material/ArrowBack\";\r\n\r\nimport Dialog from \"@mui/material/Dialog\";\r\n\r\nimport Fab from \"@mui/material/Fab\";\r\n\r\nimport { useDropzone } from \"react-dropzone\";\r\nimport DNDList from \"components/DNDList\";\r\n\r\nimport throttle from 'lodash/throttle'\r\n\r\n\r\nimport use$ui from \"store/ui\";\r\nimport use$data from \"store/data\";\r\n\r\n\r\nimport ImageCardConstructorFactory, {\r\n  getItemStyle,\r\n  getListStyle,\r\n} from \"components/ImageCardConstructorFactory\";\r\nimport useSendFiles from \"hooks/useSendFiles\";\r\nimport { Tooltip } from \"@mui/material\";\r\nimport useFetch from \"hooks/useFetch\";\r\nimport links from \"constants/links\";\r\n\r\n\r\nimport \"../startPageStyle.css\";\r\nfunction prevent(event) {\r\n  event.stopPropagation();\r\n}\r\n\r\nfunction FileCard({ activeFile }) {\r\n  const [{ files, parse_pages_result }, { updateFiles }] = use$data();\r\n  const currentFile = files.find(({ id }) => id == activeFile);\r\n\r\n  const rects = (\r\n    parse_pages_result.find(({ id }) => id == activeFile) || { rects: [] }\r\n  ).rects;\r\n  const ref = useRef();\r\n  const [size, updateSize] = useReducer(\r\n    (acc) => {\r\n      const bbox = ref.current && ref.current.getBoundingClientRect();\r\n      if (!bbox) {\r\n        setTimeout(updateSize, 100);\r\n        return acc;\r\n      }\r\n      return [bbox.width, bbox.height];\r\n    },\r\n    [\"100%\", \"100%\"]\r\n  );\r\n\r\n  useEffect(() => {\r\n    setTimeout(updateSize, 100);\r\n  }, [currentFile]);\r\n\r\n  return (\r\n    <div\r\n      style={{\r\n        overflow: \"auto\",\r\n        height: \"100%\",\r\n        width: \"100%\",\r\n        maxWidth: \"70vw\",\r\n      }}\r\n    >\r\n      <div style={{ position: \"relative\" }}>\r\n        <img\r\n          src={currentFile.preview}\r\n          ref={ref}\r\n          alt={currentFile.file.name}\r\n        ></img>\r\n        <svg\r\n          style={{ position: \"absolute\", top: 0, left: 0 }}\r\n          width={size[0]}\r\n          height={size[1]}\r\n        >\r\n          {rects.map(({ coords, literal }) => {\r\n            const path =\r\n              \"M\" +\r\n              coords\r\n                .concat([coords[0]])\r\n                .map(([x, y]) => `${x} ${y}`)\r\n                .join(\"L\");\r\n            return (\r\n              <Tooltip title={literal}>\r\n                <path className=\"wordrect\" d={path} />\r\n              </Tooltip>\r\n            );\r\n          })}\r\n        </svg>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default function StartPage() {\r\n  const [, { raiseAlert, openTab }] = use$ui();\r\n  const [\r\n    { files, socketRef, parse_pages_result, waitingTicket },\r\n    { updateFiles, set_parse_pages_result, SET_WAITING_TICKET },\r\n  ] = use$data();\r\n  const [zoomed, setZoomed] = useState(null);\r\n  const [activeFile, setActiveFile] = useState(null);\r\n\r\n  const {\r\n    send,\r\n    success: sendSuccessful,\r\n    response,\r\n  } = useSendFiles({ updateFiles });\r\n\r\n  const {\r\n    doFetch: _requestRects,\r\n    response: requestRectsResult,\r\n    error : requestRectsError,\r\n    isLoading,\r\n    isRequestingRects,\r\n  } = useFetch({\r\n    method: \"post\",\r\n    url: links.extract,\r\n  });\r\n\r\n  const requestRects = useCallback(throttle(_requestRects, 100), [])\r\n\r\n  useEffect(() => {\r\n    console.log(requestRectsResult)\r\n    if (waitingTicket && !isRequestingRects && requestRectsResult && requestRectsResult.data && requestRectsResult.data.ticket == waitingTicket) {\r\n      raiseAlert({ text: \"Данные успешно обработаны\", type: \"success\" });\r\n      SET_WAITING_TICKET(null);\r\n      set_parse_pages_result(\r\n        files\r\n          .filter((file) => file.visible)\r\n          .map(({ id }, index) => ({\r\n            id: id,\r\n            rects: requestRectsResult.data.rects[index],\r\n          }))\r\n      );\r\n    }\r\n  }, [isRequestingRects, requestRectsResult, waitingTicket]);\r\n\r\nuseEffect(() => {\r\n    if (!isRequestingRects && requestRectsError) {\r\n        setTimeout(() => {\r\n            requestRects({ data: {ticket: waitingTicket} });\r\n        },1000)\r\n    }\r\n  }, [isRequestingRects, requestRectsError, waitingTicket]);\r\n\r\n  useEffect(() => {\r\n    if (waitingTicket) {\r\n      socketRef.current.emit(\"wait\", { task: waitingTicket });\r\n      requestRects({ data: {ticket: waitingTicket} });\r\n    }\r\n    // const events = {\r\n    //   \"parse_pages-error\": () => {\r\n    //     raiseAlert({\r\n    //       text: \"при обработке данных возникла ошибка\",\r\n    //       type: \"error\",\r\n    //     });\r\n    //   },\r\n    //   parse_pages: (message) => {\r\n    //     console.log('message', message)\r\n    //     if (message != waitingTicket) {\r\n    //       console.log(\r\n    //         \"пришли данные по тикету\",\r\n    //         message.task,\r\n    //         \"сейчас ожидается\",\r\n    //         waitingTicket\r\n    //       );\r\n    //       return;\r\n    //     }\r\n    //     requestRects({ data: {ticket: message} });\r\n\r\n    //   },\r\n    // };\r\n    // for (const eventName in events)\r\n    //   socketRef.current.on(eventName, events[eventName]);\r\n\r\n    // return () => {\r\n    //   for (const eventName in events)\r\n    //     socketRef.current.off(eventName, events[eventName]);\r\n    // };\r\n  }, [waitingTicket, requestRects]);\r\n\r\n  useEffect(() => {\r\n    if (response) SET_WAITING_TICKET(response.data);\r\n  }, [response]);\r\n\r\n  const onDrop = useCallback((acceptedFiles) => {\r\n    updateFiles({ type: \"add\", files: acceptedFiles, updateFiles, raiseAlert });\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (!parse_pages_result || parse_pages_result.length == 0) send(files);\r\n  }, []);\r\n\r\n  return (\r\n    <div\r\n      width=\"100vw\"\r\n      height=\"100vh\"\r\n      className=\"pageRoot\"\r\n      style={{ maxHeight: \"100vh\" }}\r\n    >\r\n      <Fab\r\n        onClick={(event) => {\r\n          prevent(event);\r\n          openTab(\"startPage\");\r\n        }}\r\n        variant=\"extended\"\r\n        className=\"fab-prev\"\r\n      >\r\n        <ArrowBackIcon />\r\n        Вернуться к загрузке файлов\r\n      </Fab>\r\n      <Fab\r\n        onClick={(event) => {\r\n          prevent(event);\r\n          send(files);\r\n        }}\r\n        disabled={files.length == 0}\r\n        variant=\"extended\"\r\n        className=\"fab-next\"\r\n      >\r\n        <CheckBoxIcon />\r\n        Перевыполнить анализ\r\n      </Fab>\r\n      <Dialog\r\n        open={!!zoomed}\r\n        onClose={(event) => {\r\n          event.stopPropagation();\r\n          setZoomed(null);\r\n        }}\r\n      >\r\n        <img src={zoomed} onClick={prevent} />\r\n      </Dialog>\r\n\r\n      <div className=\"dropzone-calm_root\">\r\n        <div className=\"dropzone-header\"></div>\r\n        <div\r\n          onClick={prevent}\r\n          className=\"dropzone-content-container\"\r\n          style={{ display: \"flex\" }}\r\n        >\r\n          <div\r\n            style={{\r\n              flexGrow: 1,\r\n              flexBasis: \"30vw\",\r\n              position: \"relative\",\r\n              overflowY: \"auto\",\r\n            }}\r\n          >\r\n            <DNDList\r\n              items={files}\r\n              setItems={(items) => updateFiles({ type: \"set\", files: items })}\r\n              getListStyle={getListStyle}\r\n              getItemStyle={getItemStyle}\r\n              itemClickHandler={(file) => {\r\n                setActiveFile(file.id);\r\n              }}\r\n              content={ImageCardConstructorFactory({\r\n                setZoomed,\r\n                updateFiles,\r\n                canRemove: false,\r\n              })}\r\n            />\r\n          </div>\r\n          <div style={{ flexGrow: 2, flexBasis: \"70vw\", position: \"relative\" }}>\r\n            {activeFile && <FileCard activeFile={activeFile} />}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import links from 'constants/links'\r\nimport { useCallback, useEffect, useState } from 'react'\r\nimport useFetch from './useFetch'\r\n\r\nimport use$ui from 'store/ui'\r\n\r\nexport default function useSendFiles({linkName='file_receiver'}){\r\n    const [,{raiseAlert}] = use$ui();\r\n    const [success, setSuccess] = useState(null)\r\n    \r\n    const {doFetch: _send, error, isLoading, response} = useFetch({\r\n        method: 'post',\r\n        headers: {\r\n        'Content-Type': 'multipart/form-data'\r\n        },\r\n        url : links[linkName]\r\n    })\r\n\r\n    useEffect(() => {\r\n        if((!!error || !!response) && !isLoading){\r\n            setSuccess(!error)\r\n            if(!!error)\r\n                raiseAlert({text : 'При передаче данных на обработку возникли проблемы', type: 'error'})\r\n            else\r\n                raiseAlert({text : 'Данные переданы на обработку', type: 'info', duration: -1})\r\n        }\r\n\r\n    }, [error, isLoading, response])\r\n\r\n\r\n    const send = useCallback(function send(files){\r\n        const formData = new FormData();\r\n        files.forEach(({file, visible}, index) => {\r\n            if(visible)\r\n                formData.append(`page-${index}`, file)\r\n        })\r\n        _send({data: formData})\r\n    }, [])\r\n\r\n\r\n    return {send, success, response}\r\n}","// extracted by mini-css-extract-plugin\nexport default {};"],"names":["window","location","hostname","toLowerCase","links","functionResolver","basicLink","DNDList","items","setItems","getListStyle","getItemStyle","content","itemClickHandler","onDragEnd","result","console","log","destination","list","startIndex","endIndex","Array","from","splice","removed","reorder","source","index","droppableId","provided","snapshot","droppableProps","ref","innerRef","style","isDraggingOver","map","item","draggableId","id","onClick","event","draggableProps","dragHandleProps","isDragging","placeholder","ZoomableImage","file","name","setZoomed","useState","src","alt","className","stopPropagation","border","borderRadius","background","padding","margin","overflow","display","alignItems","opacity","visible","userSelect","flexDirection","width","updateFiles","canRemove","progress","loaded","preview","marginRight","Tooltip","title","IconButton","type","Close","Visibility","VisibilityOff","Math","round","defaultProps","method","headers","cors","useFetch","initialProps","err","setError","isLoading","setIsLoading","response","setResponse","props","setProps","useEffect","doRequest","finalProps","axios","resp","error","doFetch","useCallback","prevent","FileCard","activeFile","use$data","files","parse_pages_result","currentFile","find","rects","useRef","useReducer","acc","bbox","current","getBoundingClientRect","height","setTimeout","updateSize","size","maxWidth","position","top","left","coords","literal","path","concat","x","y","join","d","StartPage","use$ui","raiseAlert","openTab","socketRef","waitingTicket","set_parse_pages_result","SET_WAITING_TICKET","zoomed","setActiveFile","linkName","success","setSuccess","url","_send","text","duration","send","formData","FormData","forEach","append","data","useSendFiles","_requestRects","requestRectsResult","requestRectsError","isRequestingRects","requestRects","throttle","ticket","filter","emit","task","acceptedFiles","length","maxHeight","Fab","variant","ArrowBack","disabled","CheckBox","Dialog","open","onClose","flexGrow","flexBasis","overflowY","ImageCardConstructorFactory"],"sourceRoot":""}