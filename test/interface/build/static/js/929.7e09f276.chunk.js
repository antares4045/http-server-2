(self.webpackChunk=self.webpackChunk||[]).push([[929,45],{3091:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(1413),i=n(885),o=(n(2791),n(6574)),a=n(184);function s(e){var t=e.items,n=e.setItems,s=e.getListStyle,c=e.getItemStyle,u=e.content,l=e.itemClickHandler,f=void 0===l?function(){}:l;return(0,a.jsx)(o.Z5,{onDragEnd:function(e){console.log(e),e.destination&&n(function(e,t,n){var r=Array.from(e),o=r.splice(t,1),a=(0,i.Z)(o,1)[0];return r.splice(n,0,a),r}(t,e.source.index,e.destination.index))},children:(0,a.jsx)(o.bK,{droppableId:"droppable",children:function(e,n){return(0,a.jsxs)("div",(0,r.Z)((0,r.Z)({},e.droppableProps),{},{ref:e.innerRef,style:s(n.isDraggingOver),children:[t.map((function(e,t){return(0,a.jsx)(o._l,{draggableId:e.id,index:t,children:function(n,i){return(0,a.jsx)("div",(0,r.Z)((0,r.Z)((0,r.Z)({onClick:function(t){return f(e,t)},ref:n.innerRef},n.draggableProps),n.dragHandleProps),{},{style:(0,r.Z)((0,r.Z)({},c(i.isDragging,e)),n.draggableProps.style),children:u(e,t)}))}},e.id)})),e.placeholder]}))}})})}},1795:function(e,t,n){"use strict";n.d(t,{gI:function(){return p},lr:function(){return v}});var r=n(4942),i=n(885),o=n(2791),a=n(9823),s=n(3746),c=n(165),u=n(7411),l=n(3400),f=n(184);function d(e){var t=e.file,n=e.name,r=e.setZoomed,a=(0,o.useState)(!1),s=(0,i.Z)(a,2);s[0],s[1];return(0,f.jsx)("img",{src:t,alt:n,className:"zoomableImageContent",onClick:function(e){e.stopPropagation(),r(t)}})}var p=function(e,t){return(0,r.Z)({border:"1px solid lightgray",borderRadius:"1.5rem",background:"white",padding:3,margin:2,overflow:"hidden",display:"flex",alignItems:"center",opacity:t.visible?1:.5,userSelect:"none"},"background",e?"lightgrey":"white")},v=function(e){return{display:"flex",flexDirection:"column",width:"100%",background:e?"rgba(0,255,255,0.1)":"transparent"}};t.ZP=function(e){var t=e.setZoomed,n=e.updateFiles,r=e.canRemove,i=void 0!==r&&r;return function(e,r){var p=e.file,v=e.progress,g=e.loaded,x=e.preview,h=e.id,m=e.visible;return(0,f.jsxs)(o.Fragment,{children:[(0,f.jsxs)("div",{style:{marginRight:"auto"},children:[i?(0,f.jsx)(u.Z,{title:"\u0423\u0431\u0440\u0430\u0442\u044c \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",children:(0,f.jsx)(l.Z,{onClick:function(){return n({type:"remove",id:h})},children:(0,f.jsx)(a.Z,{})})}):null,(0,f.jsx)(u.Z,{title:m?"\u041d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443":"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",children:(0,f.jsx)(l.Z,{onClick:function(){return n({type:"visibility",id:h,visible:!m})},children:m?(0,f.jsx)(s.Z,{}):(0,f.jsx)(c.Z,{})})}),r+1,") ",p.name]}),g?(0,f.jsx)(d,{file:x,name:p.name,setZoomed:t}):"".concat(Math.round(1e4*v)/100,"%")]})}}},1726:function(e,t){"use strict";window.location.hostname.toLowerCase();var n={vision:"/vision",file_receiver:"/file_receiver",extract:"/extract"};t.Z=n},8914:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var r=n(1413),i=n(5861),o=n(885),a=n(7757),s=n.n(a),c=n(4569),u=n.n(c),l=n(2791),f={method:"get",headers:{"Content-Type":"application/x-www-form-urlencoded"},cors:!1};function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,l.useState)(null),n=(0,o.Z)(t,2),a=n[0],c=n[1],d=(0,l.useState)(!1),p=(0,o.Z)(d,2),v=p[0],g=p[1],x=(0,l.useState)(null),h=(0,o.Z)(x,2),m=h[0],Z=h[1],y=(0,l.useState)(null),j=(0,o.Z)(y,2),b=j[0],w=j[1];(0,l.useEffect)((function(){var t=function(){var t=(0,i.Z)(s().mark((function t(){var n,i;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=(0,r.Z)((0,r.Z)((0,r.Z)({},f),e),b),t.next=3,u()(n);case 3:i=t.sent,Z(i);case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();v&&(0,i.Z)(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t();case 3:e.next=9;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0),c(e.t0);case 9:g(!1);case 10:case"end":return e.stop()}}),e,null,[[0,5]])})))()}),[v,b]);var k=(0,l.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};g(!0),Z(null),c(null),w(e)}),[g,Z,c]);return{doFetch:k,error:a,isLoading:v,response:m}}},5316:function(e,t,n){"use strict";n.d(t,{Z:function(){return c}});var r=n(885),i=n(1726),o=n(2791),a=n(8914),s=n(8777);function c(e){var t=e.linkName,n=void 0===t?"file_receiver":t,c=(0,s.Z)(),u=(0,r.Z)(c,2)[1].raiseAlert,l=(0,o.useState)(null),f=(0,r.Z)(l,2),d=f[0],p=f[1],v=(0,a.Z)({method:"post",headers:{"Content-Type":"multipart/form-data"},url:i.Z[n]}),g=v.doFetch,x=v.error,h=v.isLoading,m=v.response;return(0,o.useEffect)((function(){!x&&!m||h||(p(!x),u(x?{text:"\u041f\u0440\u0438 \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0435 \u0434\u0430\u043d\u043d\u044b\u0445 \u043d\u0430 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0443 \u0432\u043e\u0437\u043d\u0438\u043a\u043b\u0438 \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u044b",type:"error"}:{text:"\u0414\u0430\u043d\u043d\u044b\u0435 \u043f\u0435\u0440\u0435\u0434\u0430\u043d\u044b \u043d\u0430 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0443",type:"info",duration:-1}))}),[x,h,m]),{send:(0,o.useCallback)((function(e){var t=new FormData;e.forEach((function(e,n){var r=e.file;e.visible&&t.append("page-".concat(n),r)})),g({data:t})}),[]),success:d,response:m}}},5929:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return b}});var r=n(885),i=n(2791),o=n(7907),a=n(7394),s=n(5562),c=n(9877),u=(n(5532),n(3091)),l=n(3038),f=n.n(l),d=n(8777),p=n(8162),v=n(1795),g=n(5316),x=n(7411),h=n(8914),m=n(1726),Z=(n(8045),n(184));function y(e){e.stopPropagation()}function j(e){var t=e.activeFile,n=(0,p.Z)(),o=(0,r.Z)(n,2),a=o[0],s=a.files,c=a.parse_pages_result,u=(o[1].updateFiles,s.find((function(e){return e.id==t}))),l=(c.find((function(e){return e.id==t}))||{rects:[]}).rects,f=(0,i.useRef)(),d=(0,i.useReducer)((function(e){var t=f.current&&f.current.getBoundingClientRect();return t?[t.width,t.height]:(setTimeout(h,100),e)}),["100%","100%"]),v=(0,r.Z)(d,2),g=v[0],h=v[1];return(0,i.useEffect)((function(){setTimeout(h,100)}),[u]),(0,Z.jsx)("div",{style:{overflow:"auto",height:"100%",width:"100%",maxWidth:"70vw"},children:(0,Z.jsxs)("div",{style:{position:"relative"},children:[(0,Z.jsx)("img",{src:u.preview,ref:f,alt:u.file.name}),(0,Z.jsx)("svg",{style:{position:"absolute",top:0,left:0},width:g[0],height:g[1],children:l.map((function(e){var t=e.coords,n=e.literal,i="M"+t.concat([t[0]]).map((function(e){var t=(0,r.Z)(e,2),n=t[0],i=t[1];return"".concat(n," ").concat(i)})).join("L");return(0,Z.jsx)(x.Z,{title:n,children:(0,Z.jsx)("path",{className:"wordrect",d:i})})}))})]})})}function b(){var e=(0,d.Z)(),t=(0,r.Z)(e,2)[1],n=t.raiseAlert,l=t.openTab,x=(0,p.Z)(),b=(0,r.Z)(x,2),w=b[0],k=w.files,C=w.socketRef,T=w.parse_pages_result,S=w.waitingTicket,E=b[1],N=E.updateFiles,F=E.set_parse_pages_result,I=E.SET_WAITING_TICKET,_=(0,i.useState)(null),R=(0,r.Z)(_,2),O=R[0],P=R[1],L=(0,i.useState)(null),A=(0,r.Z)(L,2),D=A[0],H=A[1],z=(0,g.Z)({updateFiles:N}),M=z.send,W=(z.success,z.response),B=(0,h.Z)({method:"post",url:m.Z.extract}),G=B.doFetch,$=B.response,K=B.error,q=(B.isLoading,B.isRequestingRects),U=(0,i.useCallback)(f()(G,100),[]);(0,i.useEffect)((function(){console.log($),S&&!q&&$&&$.data&&$.data.ticket==S&&(n({text:"\u0414\u0430\u043d\u043d\u044b\u0435 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u0430\u043d\u044b",type:"success"}),I(null),F(k.filter((function(e){return e.visible})).map((function(e,t){return{id:e.id,rects:$.data.rects[t]}}))))}),[q,$,S]),(0,i.useEffect)((function(){!q&&K&&setTimeout((function(){U({data:{ticket:S}})}),1e3)}),[q,K,S]),(0,i.useEffect)((function(){S&&(C.current.emit("wait",{task:S}),U({data:{ticket:S}}))}),[S,U]),(0,i.useEffect)((function(){W&&I(W.data)}),[W]);(0,i.useCallback)((function(e){N({type:"add",files:e,updateFiles:N,raiseAlert:n})}),[]);return(0,i.useEffect)((function(){T&&0!=T.length||M(k)}),[]),(0,Z.jsxs)("div",{width:"100vw",height:"100vh",className:"pageRoot",style:{maxHeight:"100vh"},children:[(0,Z.jsxs)(c.Z,{onClick:function(e){y(e),l("startPage")},variant:"extended",className:"fab-prev",children:[(0,Z.jsx)(a.Z,{}),"\u0412\u0435\u0440\u043d\u0443\u0442\u044c\u0441\u044f \u043a \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u0444\u0430\u0439\u043b\u043e\u0432"]}),(0,Z.jsxs)(c.Z,{onClick:function(e){y(e),M(k)},disabled:0==k.length,variant:"extended",className:"fab-next",children:[(0,Z.jsx)(o.Z,{}),"\u041f\u0435\u0440\u0435\u0432\u044b\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u0430\u043d\u0430\u043b\u0438\u0437"]}),(0,Z.jsx)(s.Z,{open:!!O,onClose:function(e){e.stopPropagation(),P(null)},children:(0,Z.jsx)("img",{src:O,onClick:y})}),(0,Z.jsxs)("div",{className:"dropzone-calm_root",children:[(0,Z.jsx)("div",{className:"dropzone-header"}),(0,Z.jsxs)("div",{onClick:y,className:"dropzone-content-container",style:{display:"flex"},children:[(0,Z.jsx)("div",{style:{flexGrow:1,flexBasis:"30vw",position:"relative",overflowY:"auto"},children:(0,Z.jsx)(u.Z,{items:k,setItems:function(e){return N({type:"set",files:e})},getListStyle:v.lr,getItemStyle:v.gI,itemClickHandler:function(e){H(e.id)},content:(0,v.ZP)({setZoomed:P,updateFiles:N,canRemove:!1})})}),(0,Z.jsx)("div",{style:{flexGrow:2,flexBasis:"70vw",position:"relative"},children:D&&(0,Z.jsx)(j,{activeFile:D})})]})]})]})}},7394:function(e,t,n){"use strict";var r=n(5318);t.Z=void 0;var i=r(n(5649)),o=n(184),a=(0,i.default)((0,o.jsx)("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"}),"ArrowBack");t.Z=a},7197:function(e,t,n){var r=n(7009).Symbol;e.exports=r},9066:function(e,t,n){var r=n(7197),i=n(1587),o=n(3581),a=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":a&&a in Object(e)?i(e):o(e)}},821:function(e,t,n){var r=n(6050),i=/^\s+/;e.exports=function(e){return e?e.slice(0,r(e)+1).replace(i,""):e}},1032:function(e,t,n){var r="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g;e.exports=r},1587:function(e,t,n){var r=n(7197),i=Object.prototype,o=i.hasOwnProperty,a=i.toString,s=r?r.toStringTag:void 0;e.exports=function(e){var t=o.call(e,s),n=e[s];try{e[s]=void 0;var r=!0}catch(c){}var i=a.call(e);return r&&(t?e[s]=n:delete e[s]),i}},3581:function(e){var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},7009:function(e,t,n){var r=n(1032),i="object"==typeof self&&self&&self.Object===Object&&self,o=r||i||Function("return this")();e.exports=o},6050:function(e){var t=/\s/;e.exports=function(e){for(var n=e.length;n--&&t.test(e.charAt(n)););return n}},8573:function(e,t,n){var r=n(8092),i=n(72),o=n(2582),a=Math.max,s=Math.min;e.exports=function(e,t,n){var c,u,l,f,d,p,v=0,g=!1,x=!1,h=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function m(t){var n=c,r=u;return c=u=void 0,v=t,f=e.apply(r,n)}function Z(e){return v=e,d=setTimeout(j,t),g?m(e):f}function y(e){var n=e-p;return void 0===p||n>=t||n<0||x&&e-v>=l}function j(){var e=i();if(y(e))return b(e);d=setTimeout(j,function(e){var n=t-(e-p);return x?s(n,l-(e-v)):n}(e))}function b(e){return d=void 0,h&&c?m(e):(c=u=void 0,f)}function w(){var e=i(),n=y(e);if(c=arguments,u=this,p=e,n){if(void 0===d)return Z(p);if(x)return clearTimeout(d),d=setTimeout(j,t),m(p)}return void 0===d&&(d=setTimeout(j,t)),f}return t=o(t)||0,r(n)&&(g=!!n.leading,l=(x="maxWait"in n)?a(o(n.maxWait)||0,t):l,h="trailing"in n?!!n.trailing:h),w.cancel=function(){void 0!==d&&clearTimeout(d),v=0,c=p=u=d=void 0},w.flush=function(){return void 0===d?f:b(i())},w}},8092:function(e){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},3141:function(e){e.exports=function(e){return null!=e&&"object"==typeof e}},152:function(e,t,n){var r=n(9066),i=n(3141);e.exports=function(e){return"symbol"==typeof e||i(e)&&"[object Symbol]"==r(e)}},72:function(e,t,n){var r=n(7009);e.exports=function(){return r.Date.now()}},3038:function(e,t,n){var r=n(8573),i=n(8092);e.exports=function(e,t,n){var o=!0,a=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return i(n)&&(o="leading"in n?!!n.leading:o,a="trailing"in n?!!n.trailing:a),r(e,t,{leading:o,maxWait:t,trailing:a})}},2582:function(e,t,n){var r=n(821),i=n(8092),o=n(152),a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,c=/^0o[0-7]+$/i,u=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(o(e))return NaN;if(i(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=i(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=r(e);var n=s.test(e);return n||c.test(e)?u(e.slice(2),n?2:8):a.test(e)?NaN:+e}},8045:function(e,t,n){"use strict";n.r(t),t.default={}}}]);
//# sourceMappingURL=929.7e09f276.chunk.js.map